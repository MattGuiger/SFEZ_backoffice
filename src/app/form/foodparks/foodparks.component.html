<div class="row">
  <!-- column -->

  <div class="col-md-12">
    <div class="card">
      <div class="card-body">
        <h4 class="card-title">Hub | Drivers Management</h4>
        <h6 class="card-subtitle">A Hubs listed here, and we can maname Drivers here also.</h6>
        <ngb-tabset>

          <ngb-tab title="Create Hub">
            <ng-template ngbTabContent>
              <div class="card-body">
                <!-- <h4 class="card-title">Filter Option</h4> -->
                <!-- <h5 class="card-subtitle">This is the filerable Data table</h5> -->
                <form class="m-b-30">
                  <div class="row">
                    <div class="col-sm-6">
                      <input type='text' class="form-control" placeholder='Type to filter the name column...'
                        (keyup)='updateFilter($event)' />
                    </div>
                    <div class="col-sm-6">
                      <button class="btn btn-success btn-raised" (click)="open1(content1)">Add Hub</button>
                    </div>
                  </div>
                </form>
                <ngx-datatable #table class='material' [columns]="columns" [columnMode]="'force'" [headerHeight]="50"
                  [footerHeight]="50" [rowHeight]="'auto'" [limit]="10" [rows]='rows'>
                  <ngx-datatable-column name="Name" prop="name" [width]="150"></ngx-datatable-column>
                  <ngx-datatable-column name="Country" prop="country" [width]="150"></ngx-datatable-column>
                  <ngx-datatable-column name="State" prop="state" [width]="150"></ngx-datatable-column>
                  <ngx-datatable-column name="City" prop="city" [width]="150"></ngx-datatable-column>

                  <ngx-datatable-column>
                    <ng-template ngx-datatable-cell-template let-row="row" let-value="value">
                      <!-- <input class="btn btn-success btn-raised" type="button" value="View" (click)="onCheckboxChangeFn($event,row)">&nbsp;&nbsp; -->
                      <!-- <input class="btn btn-danger btn-raised" type="button" value="Delete" (click)="onCheckboxChangeFn($event,row)"> -->
                    </ng-template>
                  </ngx-datatable-column>

                </ngx-datatable>
              </div>
            </ng-template>
          </ngb-tab>

          <ngb-tab title="Hub Management">
            <ng-template ngbTabContent>
              <div class="card-body">
                <!-- <h4 class="card-title">Filter Option</h4> -->
                <!-- <h5 class="card-subtitle">This is the filerable Data table</h5> -->
                <form class="m-b-30">
                  <div class="row">
                    <div class="col-sm-6">
                      <input type='text' class="form-control" placeholder='Type to filter the name column...'
                        (keyup)='updateFilter($event)' />
                    </div>
                    <div class="col-sm-6">
                      <button class="btn btn-success btn-raised" (click)="open1(content1)">Add Hub</button>
                    </div>
                  </div>
                </form>
                <ngx-datatable #table class='material' [columns]="columns" [columnMode]="'force'" [headerHeight]="50"
                  [footerHeight]="50" [rowHeight]="'auto'" [limit]="10" [rows]='foodparkmgrList'>
                  <ngx-datatable-column name="First Name" prop="first_name" [width]="150"></ngx-datatable-column>
                  <ngx-datatable-column name="Last Name" prop="last_name" [width]="150"></ngx-datatable-column>
                  <ngx-datatable-column name="Email" prop="username" [width]="150"></ngx-datatable-column>
                  <ngx-datatable-column name="Assign Hub">
                    <ng-template ngx-datatable-cell-template let-row="row" let-value="value">
                      <select class="form-control" (change)="selectHub($event,row,value)">
                        <option value="">Select</option>
                        <option *ngFor="let manager of rows " value="{{manager.id}}"
                          [selected]="manager.foodpark_mgr==row.id">{{manager.name}}</option>
                      </select>
                    </ng-template>
                  </ngx-datatable-column>
                  <ngx-datatable-column>
                    <ng-template ngx-datatable-cell-template let-row="row" let-value="value">
                      <input class="btn btn-success btn-raised" type="button" value="View"
                        (click)="onCheckboxChangeFn($event,row)">&nbsp;&nbsp;
                      <!-- <input class="btn btn-danger btn-raised" type="button" value="Delete" (click)="onCheckboxChangeFn($event,row)"> -->
                    </ng-template>

                  </ngx-datatable-column>

                </ngx-datatable>
              </div>
              <div class="row">
                <div class="col-sm-4"></div>
                <div class="col-sm-4">
                </div>
                <div class="col-sm-4">
                  <button class="btn btn-success btn-raised" (click)="setManagers()"
                    style="margin-right: 4%;float: right;">Save</button>
                </div>
              </div>

            </ng-template>
          </ngb-tab>

          <ng-container *ngIf = "showManagerTab">
            <ngb-tab title="Managers">
              <ng-template ngbTabContent>
                <div class="card-body">
                  <!-- <h4 class="card-title">Filter Option</h4> -->
                  <!-- <h5 class="card-subtitle">This is the filerable Data table</h5> -->
                  <form class="m-b-30">
                    <div class="row">
                      
                        <div class="col-md-2">
                          <!-- <label class="mb-3">Filter By:</label> -->
                        </div>
                        <div class="col-md-8">
                          <!-- <input type='text' class="form-control" placeholder='Type to filter the name column...'
                            (keyup)='updateManagerFilter($event)' /> -->
                        </div>
                      
                      <div class="col-md-2">
                        <button class="btn btn-success btn-raised" (click)="openManager(content3)">Create Manager </button>
                      </div>
                    </div>
                  </form>
                  <ngx-datatable class="material" #table [rows]="allManager" [columnMode]="'force'" [headerHeight]="50" [footerHeight]="50" [rowHeight]="auto" [limit]="10" [scrollbarH]="true">
                      <ngx-datatable-column name="First Name" [width]="150">
                        <ng-template let-row="row" ngx-datatable-cell-template>
                          {{row?.first_name}}
                        </ng-template>
                      </ngx-datatable-column>

                      <ngx-datatable-column name="Last Name" [width]="150">
                        <ng-template let-row="row" ngx-datatable-cell-template>
                          {{row?.last_name}}
                        </ng-template>
                      </ngx-datatable-column>

                      <!-- <ngx-datatable-column name="Email" [width]="150">
                        <ng-template let-row="row" ngx-datatable-cell-template>
                          {{row?.username}}
                        </ng-template>
                      </ngx-datatable-column> -->
                      
                      <ngx-datatable-column name="Location" [width]="150">
                        <ng-template let-row="row" ngx-datatable-cell-template>
                          {{row?.unit?.name}}
                        </ng-template>
                      </ngx-datatable-column>

                      <ngx-datatable-column name="Territory" [width]="150">
                        <ng-template let-row="row" ngx-datatable-cell-template>
                          {{row?.territory?.territory}}
                        </ng-template>
                      </ngx-datatable-column>

                      <ngx-datatable-column name="Role" [width]="150">
                        <ng-template let-row="row" ngx-datatable-cell-template>
                          <ngx-container *ngIf="row.role == 'FOODPARKMGR'; else managerrole">
                            Hub Master
                          </ngx-container>
                          <ng-template #managerrole>
                            Hub Manager
                          </ng-template>
                        </ng-template>
                      </ngx-datatable-column>

                      <ngx-datatable-column name="Actions">
                        <ng-template ngx-datatable-cell-template let-row="row" let-value="value">
                                          
                            <button type="button" class="btn btn-sm btn-success btn-icon btn-pure btn-outline delete-row-btn" data-toggle="tooltip" data-original-title="View"
                            (click)="viewCompany($event,row,'edit')">
                              <i class="ti-pencil" aria-hidden="true"></i>
                              </button>&nbsp;&nbsp;
          
                          <button type="button" class="btn btn-sm btn-icon btn-danger btn-pure btn-outline delete-row-btn" data-toggle="tooltip" data-original-title="Delete"
                          (click)="deleteManager($event,row)">
                            <i class="ti-close" aria-hidden="true"></i>
                            </button>
                          <!-- <input class="btn btn-danger btn-raised" type="button" value="Delete" (click)="deleteCompany($event,row)"/>
                          <i class="ti-close" aria-hidden="true"></i> -->
                        </ng-template>
                      </ngx-datatable-column>
                      

                  </ngx-datatable>
                </div>
              </ng-template>
            </ngb-tab>
          </ng-container>

          <ngb-tab title="Drivers">
            <ng-template ngbTabContent>
              <div class="card-body">
                <!-- <h4 class="card-title">Filter Option</h4> -->
                <!-- <h5 class="card-subtitle">This is the filerable Data table</h5> -->
                <form class="m-b-30">
                  <div class="row">
                    <div class="col-sm-4">
                      <select class="form-control" (change)="changeselectHub($event)">
                        <option value="">Select</option>
                        <option *ngFor="let manager of rows " value="{{manager.id}}"
                          ng-selected="selectedHub == namager.id">{{manager.name}}</option>
                      </select>
                    </div>
                    <div class="col-sm-6">
                      <input type='text' class="form-control" placeholder='Type to filter the name column...'
                        (keyup)='updateDriverFilter($event)' />
                    </div>
                    <div class="col-sm-2" *ngIf="user?.role=='ADMIN'">
                      <button class="btn btn-success btn-raised" (click)="openDriver(content2)">Add Driver</button>
                    </div>
                  </div>
                </form>
                <ngx-datatable #table class='material' [columns]="columns" [columnMode]="'force'" [headerHeight]="50"
                  [footerHeight]="50" [rowHeight]="'auto'" [limit]="10" [rows]='drivers'>
                  <ngx-datatable-column name="First Name" prop="first_name" [width]="150"></ngx-datatable-column>
                  <ngx-datatable-column name="Last Name" prop="last_name" [width]="150"></ngx-datatable-column>
                  <ngx-datatable-column name="UserName" prop="username" [width]="150"></ngx-datatable-column>
                  <ngx-datatable-column name="Phone" prop="phone" [width]="150"></ngx-datatable-column>
                  <ngx-datatable-column name="Assign Hub">
                    <ng-template ngx-datatable-cell-template let-row="row" let-value="value">
                      <select class="form-control" (change)="selectdriverHub($event,row,value)">
                        <option value="">Select</option>
                        <option *ngFor="let manager of rows " value="{{manager.id}}">{{manager.name}}</option>
                      </select>
                    </ng-template>
                  </ngx-datatable-column>
                  <ngx-datatable-column>
                    <ng-template ngx-datatable-cell-template let-row="row" let-value="value">
                      <!-- <input class="btn btn-success btn-raised" type="button" value="View" (click)="onCheckboxChangeFn($event,row)">&nbsp;&nbsp; -->
                      <!-- <input class="btn btn-danger btn-raised" type="button" value="Delete" (click)="onCheckboxChangeFn($event,row)"> -->
                    </ng-template>

                  </ngx-datatable-column>

                </ngx-datatable>
              </div>
              <div class="row">
                <div class="col-sm-4"></div>
                <div class="col-sm-4">
                </div>
                <div class="col-sm-4">
                  <button class="btn btn-success btn-raised" (click)="setDriverManagers()"
                    style="margin-right: 4%;float: right;">Save</button>
                </div>
              </div>
            </ng-template>
          </ngb-tab>

          

        </ngb-tabset>

      </div>
    </div>
  </div>


  <!-- <div class="col-lg-12">
    <div class="card">
      <div class="card-body">
        <form class="m-b-30">
          <div class="row">
          <div class="col-sm-6">
          <input type='text' class="form-control" placeholder='Type to filter the name column...' (keyup)='updateFilter($event)' />
        </div>
        <div class="col-sm-6">
          <button class="btn btn-success btn-raised" (click)="open1(content1)">Add Hub</button>
        </div>
      </div>
        </form>
        <ngx-datatable #table class='material' [columns]="columns" [columnMode]="'force'" [headerHeight]="50" [footerHeight]="50"
        
          [rowHeight]="'auto'" [limit]="10" [rows]='rows'>
          <ngx-datatable-column name="Name" prop="name" [width]="150"></ngx-datatable-column>
          <ngx-datatable-column name="Country" prop="country" [width]="150"></ngx-datatable-column>
          <ngx-datatable-column name="State" prop="state" [width]="150"></ngx-datatable-column>
          <ngx-datatable-column name="City" prop="city" [width]="150"></ngx-datatable-column>
          <ngx-datatable-column >
              <ng-template ngx-datatable-cell-template let-row="row" let-value="value">
                <input class="btn btn-success btn-raised" type="button" value="View" (click)="onCheckboxChangeFn($event,row)">&nbsp;&nbsp;
              </ng-template>
            </ngx-datatable-column>
        </ngx-datatable>
      </div>
    </div>
  </div> -->
</div>


<ng-template #content1 let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Add Hub</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')" id="closeModal">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <form [formGroup]="foodParkForm" (ngSubmit)="onSubmit()">
      <div class="form-group">
        <label for="name">Name</label>
        <div class="input-group">
          <input id="name" class="form-control" name="dp" type="text" formControlName="name">
        </div>
        <label for="territory">Territory</label>
        <div class="input-group">
          <select formControlName="territory_id" class="form-control">
            <option *ngFor="let item of territory" value="{{item.id}}">{{item.territory}}</option>
          </select>
        </div>

        <label for="territory">Select Location</label>
        <div class="form-group mapmarker">
          <agm-map [latitude]="lat" [longitude]="lng" [zoom]="zoom" [style.height.px]="300"
            (mapClick)="placeMarker($event)">
            <agm-marker [latitude]="lat" [longitude]="lng"></agm-marker>
          </agm-map>
        </div>

        <agm-map [latitude]="lat" [longitude]="lng" [zoom]="zoom">
          <agm-marker [latitude]="lat" [longitude]="lng"></agm-marker>
        </agm-map>

        <!-- <label for="latitude">Latitude</label>
        <div class="input-group">
          <input id="latitude" class="form-control"  name="dp" type="text" formControlName="latitude">
        </div>

        <label for="longitude">Longitude</label>
        <div class="input-group">
          <input id="longitude" class="form-control"  name="dp" type="text" formControlName="longitude">
        </div> -->

      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-outline-dark">Save</button>
      </div>
    </form>
  </div>

</ng-template>





<ng-template #content2 let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Add Driver</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')" id="closeModal">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <form [formGroup]="driverForm" (ngSubmit)="onDriverSubmit()">
      <div class="form-group">
        <label for="name">First Name</label>
        <div class="input-group">
          <input id="name" class="form-control" name="dp" type="text" formControlName="first_name">
        </div>
        <label for="name">Last Name</label>
        <div class="input-group">
          <input id="name" class="form-control" name="dp" type="text" formControlName="last_name">
        </div>
        <label for="name">Password</label>
        <div class="input-group">
          <input id="name" class="form-control" name="dp" type="password" formControlName="password">
        </div>
        <label for="name">Phone Number</label>
        <div class="input-group">
          <input id="name" class="form-control" name="dp" type="text" formControlName="phone">
        </div>
        <label for="name">Email</label>
        <div class="input-group">
          <input id="name" class="form-control" name="dp" type="text" formControlName="email">
        </div>
        <label for="territory">Territory</label>
        <div class="input-group">
          <select formControlName="territory_id" class="form-control">
            <option *ngFor="let item of territory" value="{{item.id}}">{{item.territory}}</option>
          </select>
        </div>
        <label for="territory">Hub</label>
        <div class="input-group">
          <select class="form-control" formControlName="hub_id">
            <option value="">Select</option>
            <option *ngFor="let manager of rows " value="{{manager.id}}">{{manager.name}}</option>
          </select>
        </div>



      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-outline-dark">Save</button>
      </div>
    </form>
  </div>

</ng-template>

<ng-template #content3 let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Add Manager</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')" id="closeModal">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="form-group">
      <div class="form-group row">
        <label for="name" class="col-md-3 col-form-label">Select Hub Or Location</label>
        <div class="col-md-9">
          <div class="input-group mb-2">
            <div class="input-group-prepend">
              <div class="input-group-text"><i class="fa fa-map-marker" aria-hidden="true"></i></div>
            </div>
            <select class="form-control" (change)="selectHubOrLoc($event)">
              <option>Hub</option>
              <option>Location</option>
            </select>
          </div>
        </div>
      </div>  
    </div>
    <form [formGroup]="managerForm" (ngSubmit)="onManagerSubmit()">
      <div class="form-group">
        
        <div class="form-group" *ngIf="huborlocation; else showhub">
          <div class="form-group row">
            <label for="name" class="col-md-3 col-form-label">Territory</label>
            <div class="col-md-9">
              <div class="input-group mb-2">
                <div class="input-group-prepend">
                  <div class="input-group-text"><i class="fa fa-map-marker" aria-hidden="true"></i></div>
                </div>
                <select formControlName="territory_id" class="form-control">
                  <option *ngFor="let item of territory" value="{{item.id}}">{{item.territory}}</option>
                </select>
              </div>
            </div>
          </div>  
        </div>

        <ng-template #showhub>
          <div class="form-group">
            <div class="form-group row">
              <label for="name" class="col-md-3 col-form-label">Hub</label>
              <div class="col-md-9">
                <div class="input-group mb-2">
                  <div class="input-group-prepend">
                    <div class="input-group-text"><i class="fa fa-map-marker" aria-hidden="true"></i></div>
                  </div>
                  <select class="form-control" formControlName="unitId">
                    <option value="">Select</option>
                    <option *ngFor="let unit of allUnitList" value="{{unit.id}}">{{unit.name}}</option>
                  </select>
                </div>
              </div>
            </div>  
          </div>
        </ng-template>

        <div class="form-group">
          <div class="form-group row">
            <label for="name" class="col-md-3 col-form-label">First Name</label>
            <div class="col-md-9">
              <div class="input-group mb-2">
                <div class="input-group-prepend">
                  <div class="input-group-text"><i class="fa fa-user" aria-hidden="true"></i></div>
                </div>
                <input class="form-control" name="dp" type="text" formControlName="first_name">
              </div>
            </div>
          </div>  
        </div>


        <div class="form-group">
          <div class="form-group row">
            <label for="name" class="col-md-3 col-form-label">Last Name</label>
            <div class="col-md-9">
              <div class="input-group mb-2">
                <div class="input-group-prepend">
                  <div class="input-group-text"><i class="fa fa-user" aria-hidden="true"></i></div>
                </div>
                <input class="form-control" name="dp" type="text" formControlName="last_name">
              </div>
            </div>
          </div>  
        </div>

        <div class="form-group">
          <div class="form-group row">
            <label for="name" class="col-md-3 col-form-label">Email</label>
            <div class="col-md-9">
              <div class="input-group mb-2">
                <div class="input-group-prepend">
                  <div class="input-group-text"><i class="fa fa-envelope" aria-hidden="true"></i></div>
                </div>
                <input class="form-control" name="dp" type="text" formControlName="username">
              </div>
            </div>
          </div>  
        </div>
        
        <div class="form-group">
          <div class="form-group row">
            <label for="name" class="col-md-3 col-form-label">Password</label>
            <div class="col-md-9">
              <div class="input-group mb-2">
                <div class="input-group-prepend">
                  <div class="input-group-text"><i class="fa fa-key" aria-hidden="true"></i></div>
                </div>
                <input class="form-control" name="dp" type="password" formControlName="password">
              </div>
            </div>
          </div>  
        </div>

        


        
        <!-- <label for="name">Last Name</label>
        <div class="input-group">
          <input id="name" class="form-control" name="dp" type="text" formControlName="last_name">
        </div>


        <label for="name">Username</label>
        <div class="input-group">
          <input id="name" class="form-control" name="dp" type="password" formControlName="password">
        </div>
        
        
        <label for="name">Password</label>
        <div class="input-group">
          <input id="name" class="form-control" name="dp" type="text" formControlName="phone">
        </div>
        <label for="name">Email</label>
        <div class="input-group">
          <input id="name" class="form-control" name="dp" type="text" formControlName="email">
        </div> -->
        <!-- <label for="territory">Territory</label>
        <div class="input-group">
          <select formControlName="territory_id" class="form-control">
            <option *ngFor="let item of territory" value="{{item.id}}">{{item.territory}}</option>
          </select>
        </div>
        <label for="territory">Hub</label>
        <div class="input-group">
          <select class="form-control" formControlName="hub_id">
            <option value="">Select</option>
            <option *ngFor="let manager of rows " value="{{manager.id}}">{{manager.name}}</option>
          </select>
        </div> -->



      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-outline-dark">Save</button>
      </div>
    </form>
  </div>

</ng-template>